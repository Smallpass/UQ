V8 = [361.1, 338, 285, 242.4, 227.5, 231.7, 259, 312, 355.1, 355.8, 314.3, 261.2, 232.8, 227, 239.2, 278.1, 332.9, 360.7, 344, 293.6, 247.5, 229, 228.8, 247.9, 294.1, 344.9, 360.7, 332.7, 280.1, 240.8, 227.5, 230.4, 253, 302.7, 349.3, 359.3, 327.6, 274.3, 239, 227.5, 230.6, 253, 302.1, 349.3, 360, 328.5, 276.8, 240.6, 227.7, 229.5, 247.9, 291.8, 342.2, 360.9, 337.6, 287.2, 246.8, 229.3, 227.5, 239.5, 273.4, 325.6, 358.9, 350.9, 307.6, 260.1, 234.4, 227, 230.8, 249.7, 294.1, 342.9, 360.9, 338.9, 291.6, 249.5, 231.3, 227, 232.8, 254.8, 299.2, 347.1, 360.7, 335.1, 287.9, 248.6, 231.3, 227, 230.8, 248.1, 287.9, 337.8, 360.9, 345.1, 300.7, 257.9, 235.3, 227.7, 227.7, 235.7, 260.6, 305.4, 349.1, 360.4, 335.4, 288.7, 251.2, 233, 227.5, 227.5, 233, 251.7, 291.6, 338.2, 360.7, 348.7, 307.2, 263.9, 239, 229.7, 227.3, 227.3, 231.5, 244.4, 275.9, 322.7, 356.2, 357.3, 326.7, 281, 248.8, 233.9, 228.8, 227.3, 227, 227.3, 229.7, 237.5, 259.2, 300.1, 342.9, 360.9, 347.6, 308.7, 267.2, 242.1];

p8 = [-53, -4, 220, 572, 783, 779, 569, 219, -13, -49, 76, 384, 695, 802, 717, 433, 100, -46, -23, 174, 515, 754, 796, 655, 326, 38, -54, 14, 252, 592, 781, 782, 610, 270, 17, -53, 31, 287, 609, 783, 780, 609, 272, 14, -53, 30, 265, 595, 774, 785, 646, 345, 49, -52, -1, 209, 522, 745, 796, 709, 454, 136, -35, -35, 108, 399, 672, 786, 772, 625, 320, 40, -52, -4, 187, 498, 718, 792, 757, 589, 284, 24, -55, 7, 208, 507, 716, 789, 767, 634, 354, 69, -50, -20, 142, 417, 660, 770, 785, 725, 538, 247, 11, -54, 10, 204, 481, 692, 771, 784, 744, 604, 325, 66, -43, -25, 115, 371, 614, 736, 774, 778, 751, 653, 429, 147, -19, -46, 40, 250, 506, 677, 748, 767, 771, 770, 754, 698, 536, 270, 44, -44, -24, 106, 341, 576];


V10 = [322, 256.8, 227.5, 240.4, 296.5, 352.4, 351.3, 293.8, 239.9, 227.3, ...
258.8, 322.9, 360.4, 333.1, 267, 229.3, 233.9, 283.4, 345.1, 357.3, ...
307.2, 247.9, 226.6, 247.2, 310, 358, 343.8, 281.4, 234.1, 229, ...
268.3, 331.6, 360.7, 324.7, 260.3, 227.7, 237.2, 289.4, 350, 355.5, ...
302.3, 244.4, 226.6, 249.9, 311.8, 358.7, 343.1, 279.9, 234.1, 229.5, ...
266.1, 331.4, 360.7, 326.7, 262.6, 228.6, 235.5, 285, 345.6, 357.3, ...
307.6, 247.9, 226.6, 245.5, 303.4, 356.7, 347.8, 289.6, 237.9, 227.7, ...
259.7, 324.7, 360.4, 332.9, 268.8, 230.4, 232.8, 277.9, 341.6, 359.1, ...
314.3, 252.3, 227, 241.9, 297, 353.8, 351.8, 294.1, 240.6, 227.3, ...
255.2, 319.1, 360, 337.6, 273.9, 231.7, 231, 272.3, 338, 360, ...
321.6, 256.1, 227.5, 238.4, 290.1, 350.2, 355.1, 301.2, 243.2, 226.6, ...
249.5, 312.3, 358.4, 342.9, 282.5, 235.5, 228.4, 263.2, 328.2, 360.7, ...
329.8, 265.9, 229.5, 233.7, 279.6, 342.7, 358.7, 313.4, 251.9, 226.8, ...
241.5, 297.2, 352.9, 352, 297.6, 241.5, 226.6, 253, 314.5, 358.7, ...
342.7, 279.4, 233.9, 229.3, 265.2, 330, 360.7, 328.5, 264.5, 229.3, ...
233.7, 281.2, 342.7, 358.9, 312.5, 252.3, 227, 241.2, 294.3, 352.2, ...
352.9, 298.1, 241.7, 226.6, 249.9, 312.5, 358, 344.2, 283.2, 235.5, ...
228.4, 259.9, 325.6, 360.4, 332.9, 269, 230.4, 232.1, 275.4, 339.3, ...
359.5, 316.7, 254.6, 227.3, 238.6, 291.4, 350.2, 355.1, 301.8, 244.6, ...
226.6, 247.5, 308.7, 357.1, 347.1, 286.1, 236.1, 227.7, 259.2, 323.6, ...
360.4, 334.5, 270.5, 230.8, 231.5, 276.3, 338, 359.8, 319.4, 257.7, ...
227.5, 237.5, 290.5, 348.9, 355.5, 302.5, 245.7, 226.6, 246.8, 306.7, ...
357.3, 346.7, 286.7, 237, 227.9, 259.4, 323.8, 360.2, 334, 271.4, ...
231, 231.7, 274.3, 337.6, 360, 318.5, 255.7, 227.5, 238.1, 292.1, ...
350.4, 353.6, 300.9, 243.9, 226.6, 248.6, 308.3, 358, 344.7, 285, ...
236.1, 228.6, 261.4, 324.9, 360.4, 331.6, 266.3, 229.9, 232.8, 277.4, ...
341.1, 358.7, 315.2, 253.2, 226.8, 239.7, 295.4, 352.2, 352.7, 297.2, ...
241.9, 226.6, 252.1, 313.4, 358.9, 340.9, 279.6, 234.4];

p10 = [38, 412, 792, 736, 329, 6, -46, 148, 598, 821, ...
591, 175, -47, 3, 324, 745, 779, 415, 51, -54, ...
93, 501, 818, 681, 245, -22, -28, 230, 673, 819, ...
523, 123, -53, 31, 380, 781, 754, 378, 18, -51, ...
115, 544, 821, 659, 234, -32, -25, 245, 673, 814, ...
540, 130, -44, 20, 360, 766, 770, 408, 47, -51, ...
91, 507, 820, 695, 291, -14, -35, 178, 619, 824, ...
588, 171, -43, 2, 311, 734, 793, 460, 72, -51, ...
70, 453, 805, 724, 329, 0, -44, 156, 588, 829, ...
620, 192, -36, -5, 271, 713, 808, 498, 87, -51, ...
42, 410, 791, 751, 374, 20, -50, 124, 558, 828, ...
666, 239, -25, -22, 228, 659, 830, 565, 147, -45, ...
17, 344, 756, 792, 447, 67, -48, 78, 460, 812, ...
734, 330, 7, -42, 143, 580, 831, 642, 224, -27, ...
-25, 244, 683, 824, 548, 140, -44, 23, 348, 762, ...
792, 448, 73, -48, 93, 460, 811, 734, 354, 12, ...
-41, 149, 578, 834, 667, 251, -18, -30, 220, 660, ...
830, 590, 163, -42, 6, 312, 740, 803, 481, 84, ...
-50, 64, 429, 802, 753, 370, 27, -44, 130, 550, ...
834, 688, 266, -10, -28, 214, 654, 835, 600, 182, ...
-36, 5, 304, 739, 815, 494, 93, -50, 53, 405, ...
804, 767, 378, 31, -46, 125, 535, 832, 696, 274, ...
-15, -27, 206, 646, 836, 596, 173, -40, 1, 303, ...
728, 812, 489, 94, -50, 55, 426, 798, 762, 370, ...
25, -41, 132, 550, 835, 682, 269, -19, -24, 216, ...
657, 835, 584, 169, -39, 14, 337, 752, 804, 489, ...
71, -46, 72, 454, 819, 752, 357, 16, -40, 149, ...
582, 842, 663, 244, -16, -13, 261, 684];

V12 = [270.1, 228.8, 247.9, 315.6, 362, 330.7, 257, 227.9, 255.4, 328.5, ...
362, 318.7, 249.9, 228.4, 266.5, 338.2, 360.4, 309.4, 243.9, 229.7, ...
273.2, 343.8, 358, 302.5, 240.4, 231.5, 280.1, 347.3, 355.5, 296.1, ...
236.8, 232.6, 285.4, 351.3, 353.1, 289.4, 234.8, 235.3, 289.9, 353.6, ...
350, 284.3, 234.1, 235.9, 290.7, 354.4, 348.9, 284.3, 233.3, 236.4, ...
291.8, 353.8, 349.3, 285, 232.6, 237.2, 293.6, 355.1, 349.3, 283.9, ...
233.3, 236.1, 292.3, 354.4, 350.4, 285.6, 234.6, 234.4, 287.6, 352.7, ...
352.4, 288.1, 235.5, 233.3, 282.7, 350.7, 355.1, 295.2, 238.6, 231, ...
276.3, 344.7, 358.2, 302.3, 242.4, 229.7, 270.5, 340.9, 360.4, 311.8, ...
246.3, 228.1, 262.8, 332.2, 362, 321.1, 252.8, 227.9, 253.5, 321.4, ...
362, 329.6, 261.2, 228.4, 247.7, 312.7, 360.4, 339.3, 271.4, 230.4, ...
240.1, 299.2, 356, 348.9, 284.5, 233.7, 234.6, 284.7, 348.7, 354.9, ...
296.1, 239.7, 230.1, 273, 341.1, 359.5, 310.3, 246.8, 228.1, 261.9, ...
329.6, 362, 324.9, 256.3, 227.9, 250.1, 317.6, 361.3, 337.3, 268.1, ...
229.7, 242.4, 300.5, 357.8, 346.4, 282.3, 232.6, 235.5, 288.7, 351.8, ...
353.8, 293.2, 238.1, 231, 277.2, 344.7, 358, 304.5, 243, 229.3, 267.2, ...
336.7, 361.1, 314.7, 249.2, 228.1, 259.4, 328.9, 362, 322.9, 256.3, ...
227.9, 253, 321.1, 362, 330.5, 260.6, 228.4, 247, 312.3, 360.4, 338, ...
269.4, 229.7, 241.9, 303.6, 358.4, 344.5, 277.4, 231.7, 237.7, 295, ...
355.1, 350.4, 286.7, 234.1, 233.9, 286.7, 349.3, 354, 293.2, 237.2, ...
231.3, 278.1, 345.8, 357.1, 300.1, 240.4, 230.4, 273.4, 342.5, 359.3, ...
307.8, 244.6, 229.3, 267.9, 339.1, 360.9, 311.8, 246.8, 228.4, 262.1, ...
333.6, 361.5, 315.4, 249.9, 228.1, 259, 330.5, 361.5, 319.8, 252.1, ...
227.9, 257.2, 325.8, 362, 323.1, 254.6, 227.9, 255.2, 324.9, 362, ...
325.4, 257.4, 227.9, 253.7, 323.1, 362, 325.8, 257.7, 227.9, 252.3, ...
321.4, 362, 328.2, 257.4, 228.1, 251.9, 320.9, 361.8, 328.5, 258.8, ...
228.1, 251.2, 321.8, 362, 328.9, 257.7, 227.9, 253.7, 322.5, 362, ...
326.5, 255.4, 227.9, 256.3, 327.4, 362, 321.1, 252.1, 227.9, 261, ...
334, 361.3, 316, 247, 228.8, 268.1, 340.7];

p12 = [294, 781, 680, 220, -54, 6, 406, 814, 636, 142, ...
-57, 43, 486, 825, 540, 83, -61, 86, 550, 819, ...
496, 63, -57, 116, 600, 815, 453, 67, -52, 150, ...
651, 807, 415, 19, -46, 185, 679, 781, 382, -3, ...
-40, 212, 695, 787, 376, -1, -42, 210, 701, 773, ...
368, 0, -41, 210, 709, 775, 353, -3, -40, 225, ...
706, 775, 367, 0, -45, 209, 686, 788, 397, 14, ...
-47, 192, 671, 800, 438, 28, -49, 155, 620, 818, ...
476, 58, -55, 119, 579, 820, 510, 81, -61, 81, ...
518, 828, 578, 129, -55, 43, 458, 817, 642, 196, ...
-50, 17, 379, 799, 687, 261, -33, -16, 294, 764, ...
748, 340, -8, -46, 213, 700, 792, 414, 36, -52, ...
143, 607, 823, 503, 70, -57, 84, 525, 827, 582, ...
150, -50, 33, 425, 817, 671, 214, -36, -6, 322, ...
776, 737, 318, -14, -36, 222, 718, 785, 399, 21, ...
-49, 158, 630, 816, 472, 58, -53, 103, 563, 823, ...
544, 101, -58, 61, 482, 823, 602, 149, -52, 36, ...
421, 820, 652, 207, -44, 15, 389, 807, 698, 253, ...
-30, -21, 309, 773, 741, 300, -20, -29, 252, 735, ...
771, 358, 1, -39, 210, 694, 799, 410, 37, -56, ...
163, 647, 819, 483, 53, -55, 128, 602, 822, 501, ...
69, -55, 94, 552, 831, 545, 90, -56, 79, 524, ...
834, 590, 128, -54, 43, 485, 832, 609, 144, -57, ...
49, 466, 831, 623, 168, -52, 34, 438, 828, 640, ...
176, -53, 25, 415, 825, 653, 186, -47, 27, 412, ...
820, 665, 198, -39, 19, 412, 819, 668, 202, -47, ...
16, 398, 818, 670, 193, -45, 15, 410, 823, 651, ...
192, -50, 22, 429, 827, 636, 160, -55, 36, 455, ...
833, 595, 129, -57, 66, 518, 836, 551, 85];


 V14 = [
    226.8, 270.5, 352, 340, 257.7, 228.8, 293.2, 359.8, 324.3, 241.5, ...
    236.6, 314.7, 360.9, 301.2, 231.3, 249, 336.7, 354.7, 277.9, 226.8, ...
    269.2, 351.8, 341.1, 255, 229, 297.2, 360.2, 316.9, 237.5, 241.2, ...
    324.5, 358.7, 288.3, 228.1, 263, 347.3, 343.6, 260.3, 228.6, 292.3, ...
    359.5, 318.3, 238.6, 241.2, 323.6, 357.5, 289.9, 227.7, 265, 349.1, ...
    343.1, 255.9, 229.9, 300.7, 360.7, 311.6, 233, 249.2, 335.1, 352.4, ...
    269, 227, 283.2, 358.4, 322.9, 238.1, 241.2, 324.9, 356.4, 280.8, ...
    226.6, 274.3, 355.8, 331.1, 243, 237.9, 322.5, 358.2, 285.6, 226.6, ...
    275, 355.5, 329.1, 242.4, 239, 324.7, 356.7, 279.9, 226.6, 280.5, ...
    357.8, 323.4, 238.1, 243.7, 332.5, 353.6, 270.1, 227.3, 291.8, 360.2, ...
    311.6, 232.1, 253.9, 345.1, 344.7, 255.4, 231.7, 311.8, 360.4, 289.2, ...
    227, 274.1, 356.9, 323.6, 237.2, 245.5, 337.8, 349.1, 260.3, 230.1, ...
    306.3, 360.4, 291.2, 227.3, 275.9, 356.4, 322, 235, 249.5, 341.1, ...
    345.8, 256.8, 232.8, 318.5, 358.7, 280.3, 226.6, 289, 360.4, 309.6, ...
    229.9, 261.9, 352.4, 331.4, 241.9, 244.1, 338, 348.9, 258.1, 231.3, ...
    316.3, 358.4, 278.1, 226.8, 295.2, 360.9, 298.3, 227.7, 274.1, 358.2, ...
    316.3, 232.6, 259.9, 351.3, 331.6, 239.5, 247.2, 341.6, 343.1, 249.5, ...
    239.2, 330.5, 351.6, 259.9, 232.1, 317.2, 357.5, 270.5, 228.8, 308.7, ...
    359.5, 277.9, 227, 299.8, 360.4, 287.9, 226.6, 292.5, 360.9, 294.5, ...
    226.6, 284.5, 360.7, 299.6, 227, 282.7, 360.2, 300.7, 227.5, 277.9, ...
    360, 304.9, 227.5, 280.8, 359.8
];

p14 = [
    810, 531, 15, -38, 370, 840, 380, -38, 6, 537, ...
    788, 238, -55, 92, 707, 697, 121, -63, 214, 817, ...
    548, 20, -34, 387, 843, 358, -42, 29, 595, 765, ...
    184, -64, 157, 774, 600, 46, -42, 309, 848, 400, ...
    -33, 29, 585, 770, 213, -63, 140, 796, 592, 43, ...
    -42, 376, 847, 344, -43, 58, 679, 712, 124, -59, ...
    274, 854, 466, -22, 16, 591, 778, 193, -55, 188, ...
    837, 528, 1, -13, 519, 799, 202, -66, 169, 824, ...
    527, 3, -4, 535, 797, 200, -59, 204, 835, 357, ...
    -14, 13, 588, 766, 153, -57, 273, 865, 416, -33, ...
    48, 689, 688, 75, -45, 384, 854, 296, -53, 144, ...
    815, 542, -6, 8, 612, 757, 122, -57, 349, 865, ...
    319, -58, 134, 814, 534, 0, 17, 644, 749, 100, ...
    -49, 377, 866, 247, -51, 209, 870, 467, -30, 59, ...
    745, 639, 28, -6, 538, 778, 123, -50, 360, 869, ...
    279, -50, 214, 877, 410, -39, 107, 800, 570, -6, ...
    44, 699, 668, 62, -14, 583, 768, 105, -35, 450, ...
    839, 202, -42, 349, 873, 272, -49, 263, 883, 322, ...
    -49, 215, 882, 382, -52, 167, 873, 438, -33, 122, ...
    851, 502, -19, 103, 825, 517, -23, 101, 823, 556, ...
    -13, 77, 821, 525, -14
];


V16 = [226.8, 270.5, 352, 340, 257.7, 228.8, 293.2, 359.8, 324.3, 241.5, 236.6, 314.7, 360.9, 301.2, 231.3, 249, 336.7, 354.7, 277.9, 226.8, ...
269.2, 351.8, 341.1, 255, 229, 297.2, 360.2, 316.9, 237.5, 241.2, 324.5, 358.7, 288.3, 228.1, 263, 347.3, 343.6, 260.3, 228.6, 292.3, 359.5, ...
318.3, 238.6, 241.2, 323.6, 357.5, 289.9, 227.7, 265, 349.1, 343.1, 255.9, 229.9, 300.7, 360.7, 311.6, 233, 249.2, 335.1, 352.4, 269, 227, ...
283.2, 358.4, 322.9, 238.1, 241.2, 324.9, 356.4, 280.8, 226.6, 274.3, 355.8, 331.1, 243, 237.9, 322.5, 358.2, 285.6, 226.6, 275, 355.5, ...
329.1, 242.4, 239, 324.7, 356.7, 279.9, 226.6, 280.5, 357.8, 323.4, 238.1, 243.7, 332.5, 353.6, 270.1, 227.3, 291.8, 360.2, 311.6, 232.1, ...
253.9, 345.1, 344.7, 255.4, 231.7, 311.8, 360.4, 289.2, 227, 274.1, 356.9, 323.6, 237.2, 245.5, 337.8, 349.1, 260.3, 230.1, 306.3, 360.4, ...
291.2, 227.3, 275.9, 356.4, 322, 235, 249.5, 341.1, 345.8, 256.8, 232.8, 318.5, 358.7, 280.3, 226.6, 289, 360.4, 309.6, 229.9, 261.9, 352.4, ...
331.4, 241.9, 244.1, 338, 348.9, 258.1, 231.3, 316.3, 358.4, 278.1, 226.8, 295.2, 360.9, 298.3, 227.7, 274.1, 358.2, 316.3, 232.6, 259.9, ...
351.3, 331.6, 239.5, 247.2, 341.6, 343.1, 249.5, 239.2, 330.5, 351.6, 259.9, 232.1, 317.2, 357.5, 270.5, 228.8, 308.7, 359.5, 277.9, 227, ...
299.8, 360.4, 287.9, 226.6, 292.5, 360.9, 294.5, 226.6, 284.5, 360.7, 299.6, 227, 282.7, 360.2, 300.7, 227.5, 277.9, 360, 304.9, 227.5, ...
280.8, 359.8, 305.4, 227.7, 279, 360, 304.5, 227.5, 280.5, 359.8, 302.3, 227, 283.6, 360.7, 298.7, 226.6, 285.6, 360.7, 294.3, 226.6, 292.5, ...
360.9, 289, 226.8, 298.3, 360.7, 283.2, 227, 304.7, 359.1, 276.8, 228.4, 311.2, 358.7, 269, 229.7, 316.7, 356.2, 267.7, 231.7, 322, 354, ...
259.2, 233.7, 326.5, 352, 257.4, 235.5, 329.6, 348.9, 256.8, 235.7, 331.4, 348, 255.7, 237.2, 331.6, 349.3, 254.6, 237.5];

p16 = [810, 531, 15, -38, 370, 840, 380, -38, 6, 537, 788, 238, -55, 92, 707, 697, 121, -63, 214, 817, ...
548, 20, -34, 387, 843, 358, -42, 29, 595, 765, 184, -64, 157, 774, 600, 46, -42, 309, 848, 400, -33, ...
29, 585, 770, 213, -63, 140, 796, 592, 43, -42, 376, 847, 344, -43, 58, 679, 712, 124, -59, 274, 854, ...
466, -22, 16, 591, 778, 193, -55, 188, 837, 528, 1, -13, 519, 799, 202, -66, 169, 824, 527, 3, -4, ...
535, 797, 200, -59, 204, 835, 491, -14, 13, 588, 766, 153, -57, 273, 865, 416, -33, 48, 689, 688, 75, ...
-45, 384, 854, 296, -53, 144, 815, 542, -6, 8, 612, 757, 122, -57, 349, 865, 319, -58, 134, 814, 534, ...
0, 17, 644, 749, 100, -49, 377, 866, 247, -51, 209, 870, 467, -30, 59, 745, 639, 28, -6, 538, 778, ...
123, -50, 360, 869, 279, -50, 214, 877, 410, -39, 107, 800, 570, -6, 44, 699, 668, 62, -14, 583, 768, ...
105, -35, 450, 839, 202, -42, 349, 873, 272, -49, 263, 883, 322, -49, 215, 882, 382, -52, 167, 873, ...
438, -33, 122, 851, 502, -19, 103, 825, 517, -23, 101, 823, 556, -13, 77, 821, 525, -14, 79, 807, ...
537, -13, 79, 816, 530, -15, 93, 822, 508, -23, 112, 852, 497, -30, 130, 861, 445, -34, 157, 883, ...
394, -49, 180, 881, 358, -52, 220, 882, 302, -55, 278, 876, 266, -54, 294, 865, 228, -53, 346, 855, ...
196, -49, 364, 836, 187, -43, 378, 834, 161, -41, 388, 819, 164, -48, 400, 813];

format long g

values(p8, V8, 8, 50+273)
values(p10, V10, 10, 55+273)
values(p12, V12, 12, 63+273)
values(p14, V14, 14, 70+273)



figure; % Create a new figure

% Plot each P-V curve
hold on; % Keep the previous plot and overlay new plots
plot(V8, p8, 'r', 'DisplayName', '8V'); % Red line for curve 1
plot(V10, p10, 'g', 'DisplayName', '10V'); % Red line for curve 1
plot(V12, p12, 'b', 'DisplayName', '12V'); % Green dashed line for curve 2
plot(V14, p14, 'm', 'DisplayName', '14V'); % Blue dotted line for curve 3

% Add labels and title
xlabel('Volume (cm^3)');
ylabel('Pressure (hPa)');
title('P-V Diagrams for Stirling Engines');
legend show; % Display legend to identify each curve


hold off; % Release the plot hold


%Plotting Work vs Voltage

Voltage = [8, 10, 12, 14];
Work = [1.4, 1.7, 1.75, 2.0];
Wuncert = [0.3, 0.2, 0.07, 0.5];

% Plot with error bars
figure;
errorbar(Voltage, Work, Wuncert, '-o', 'LineStyle', 'none', 'LineWidth', 1.5, 'MarkerSize', 8);

% Labels and title
xlabel('Voltage (V)');
ylabel('Work (J)');
title('Stirling engine Work for Resistive element Voltages');
grid on;
xlim([6 16]);
ylim([0 3]);

Peta = [0.028, 0.033, 0.026, 0.03];
PetaUncert = [0.006, 0.004, 0.001, 0.007];

Ieta = [0.03, 0.037, 0.038, 0.04];
IetaUncert = [0.007, 0.005, 0.003, 0.01];

Ceta = [0.0836, 0.098, 0.119, 0.137];
CetaUncert = [0.0004, 0.004, 0.0005, 0.0006];


errorbar(Voltage, Peta, PetaUncert, 'o', 'DisplayName', 'Practical Efficiency');
hold on;
errorbar(Voltage, Ieta, IetaUncert, 'o', 'DisplayName', 'Internal Efficiency');
errorbar(Voltage, Ceta, CetaUncert, 'o', 'DisplayName', 'Carnot Efficiency');
set(gca, 'YScale', 'log');  % <-- log scale on y-axis
xlabel('Voltage');
ylabel('Efficiency (log scale)');
legend;
xlim([6 16]);
ylim([0.02 0.15]);
grid on;

function [] = values(p, V, Voltage, Temp)
    disp(Voltage)
    % Ensure p and V are column vectors
    p = p(:);
    V = V(:);

    % Count loops by detecting local maxima in pressure
    loops = 0;
    for j = 2:length(p)-1
        if p(j-1) < p(j) && p(j) >= p(j+1)
            loops = loops + 1;
        end
    end

    % Compute total work using polygon area (signed area)
    totalWork = polyarea(p, V) / (10000);  % Convert to Joules
    work = totalWork / loops;

    % Estimate time per cycle
    time = 50e-3 * length(p) / loops;
    disp(['The time of one cycle was: ' num2str(time) ' seconds'])

    % Compute power
    power = work / time;
    disp(['Therefore the power output was: ' num2str(power) ' Watts'])

    % Estimate uncertainty in work by comparing each cycle's work to the mean
    pointsPerLoop = floor(length(p)/loops);
    Wuncert = 0;

    for j = 0:loops-1
        cyclestart = j * pointsPerLoop + 1;
        cycleend = (j+1) * pointsPerLoop;

        onecycleP = p(cyclestart:cycleend);
        onecycleV = V(cyclestart:cycleend);
        CycleWork = polyarea(onecycleP, onecycleV) / 10000;
        Wuncert = Wuncert + (CycleWork - work)^2;
    end
    Wuncert = sqrt(Wuncert / (loops - 1));
    disp(['The amount of work done was: ' num2str(work) '±' num2str(Wuncert) ' Joules'])

    

    %Calculate Practical efficiency
    practicaleta = work / (Voltage^2 / 0.65 * time);
    practicaletauncert = practicaleta*sqrt((Wuncert/work)^2+(0.01/0.65)^2);
    disp(['The practical efficiency was: ' num2str(practicaleta) '±' num2str(practicaletauncert)])
    
    %Find heat into gas
    MaxV = 0;
    PmaxV = 0;
    Maxloop = 0;

    MinV = 0;
    PminV = 0;
    Minloop = 0;
    for j = 2:length(p)-1
        if V(j-1) < V(j) && V(j) >= V(j+1)
            MaxV = MaxV + V(j);
            PmaxV = PmaxV + p(j);
            Maxloop = Maxloop + 1;
        end

        if V(j-1) > V(j) && V(j) <= V(j+1)
            MinV = MinV + V(j);
            PminV = PminV + p(j);
            Minloop = Minloop + 1;

        end
    end
    MaxV = MaxV/Maxloop;
    PmaxV = PmaxV/Maxloop;
    MinV = MinV/Minloop;
    PminV = PminV/Minloop;


    U = 5/2 * (MinV*PminV-MaxV*PmaxV);
    IsothermV = [];
    IsothermP = [];
    for j = 2:length(p)-1
        if V(j)>V(j+1) && p(j)<p(j+1)
            IsothermV = [IsothermV, V(j)];
            IsothermP = [IsothermP, p(j)];
        end
    end
    [IsothermV_sorted, sortIdx] = sort(IsothermV);  % Sort V in ascending order
    IsothermP_sorted = IsothermP(sortIdx);  
    ExpansionW = polyarea(IsothermV_sorted, IsothermP_sorted);

    %Find internal uncert
deltaV = 10;   % Uncertainty in volume in mL
deltaP = 9;    % Uncertainty in pressure in kPa

% Internal energy uncertainty propagation
InternalEnergyUncert = sqrt( ...
    (5/2)^2 * ( (PminV * deltaV)^2 + (MinV * deltaP)^2 + ...
                (PmaxV * deltaV)^2 + (MaxV * deltaP)^2 ) );
    disp(['U = ' num2str(U) '±' num2str(InternalEnergyUncert)])

% Expansion work uncertainty via trapezoidal approximation
ExpansionWUncert = 0;
for j = 1:length(IsothermP_sorted)-1
    dv = IsothermV_sorted(j+1) - IsothermV_sorted(j);
    dp_avg = 0.5 * (IsothermP_sorted(j) + IsothermP_sorted(j+1));

    ExpansionWUncert = ExpansionWUncert + ...
        (0.5 * dv * deltaP)^2 + (0.5 * dp_avg * deltaV)^2;
end
ExpansionWUncert = sqrt(ExpansionWUncert);

% Total Q uncertainty
QUncert = sqrt(InternalEnergyUncert^2 + ExpansionWUncert^2) / 10000;


% Display results
U = 5/2 * (MinV * PminV - MaxV * PmaxV);
ExpansionW = polyarea(IsothermV_sorted, IsothermP_sorted);
Q = (U - ExpansionW)/10000;

    disp(['Q = ', num2str(Q), ' ± ', num2str(QUncert)])
    disp(['Thus the internal efficiency was: ' num2str(work/((U-ExpansionW)/10000)) ...
        '±' num2str(work/Q *sqrt((Wuncert/work)^2+(QUncert/Q)^2))])
    


    %Finding Carnot efficiency
    c = 1 - (273+23)/Temp;
    Cuncert = c*sqrt((1/Temp)^2+(1/(273+23))^2);
    disp(['The carnot efficiency was: ' num2str(c) '±' num2str(Cuncert)])

    disp('------------------')
end



